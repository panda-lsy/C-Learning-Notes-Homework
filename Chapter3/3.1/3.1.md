# 模块化程序设计

## 什么是模块化程序设计？

**模块**：是程序中具有相对独立功能的部分，有明确的输入和输出，可看作一个黑盒，使用者只需要关注其功能和接口，不必了解其内部实现细节

**接口**：是模块与外界交互的通道，规定了模块的输入输出方式，像函数的参数和返回值就是函数模块的接口

## 设计原则

**高内聚**:指模块内部元素联系紧密，每个模块只完成一个明确功能，避免一个模块承担过多任务

**低耦合**:表示模块之间的依赖关系要尽量简单，一个模块的修改对其他模块的影响要小。

## 主要优点

提高可维护性：程序拆分为多个模块后，各模块相对独立，若某个模块出现问题，只需针对该模块进行调试和修改，不会影响其他模块，大大降低了维护复杂度与成本。

增强可扩展性：当需要为程序添加新功能时，只需开发新的模块并与现有模块集成即可，对原有系统改动较小

实现代码复用：一个模块开发完成后，可在多个程序或项目中重复使用，减少了重复开发的工作量，提高了开发效率

便于团队协作：不同模块可由不同的开发人员同时进行开发，可以充分发挥团队成员优势，加快项目开发进度。

# 函数

引例中，我们设计了一个求最大公约数的程序。但是如果程序很大，在很多处会使用求两数的最大公约数，该怎么办呢？

在3.1-1.c中，程序将求最大公约数的功能**封装**到了GCD函数中.

```c
int gcd(int a,int b){
    int temp;
    if (a<b){
        temp=a;
        a=b;
        b=temp;
    }
    while (b!=0){
        temp=b;
        b=a%b;
        a=temp;
    }
    return a;
}
```

其中，`gcd`为函数名，`int a,int b`为函数参数，`int`为函数返回值类型。`return a;`为函数的返回值。

前者为输入接口，后者为输出接口。

## 函数的定义

例：编写求$n!(n>0)$的函数

见3.1-2.c

## 函数参数

### 作用

函数的参数是用来在函数外部向函数传递数据的；相当于函数的输入

函数参数可以分为两类：形式参数（简称形参）和实际参数（简称实参）

### 形式参数(形参)

### 实际参数(实参)

实际参数是在函数调用时传递给函数的值。这些值可以是变量、常量或表达式的结果。

**注意：实参的数据类型必须与相应的形参数据类型匹配或兼容**

如3.1-2中的 `long int answer = factorial(inp_num);` 将 `inp_num`作为实参传递给 `factorial()`函数中的形参 `num`。

形参与实参所用的内存空间不一样。如果不返回值，实参的值不会改变（函数结束后形参的内存会被释放掉）。

## 函数的返回值

函数的返回值是指函数被调用之后，执行函数体中的代码所得到的结果，这个结果通过 **return** 语句返回。

return 语句的一般形式为：

```
return 表达式;
```

## 变量作用域与生命周期

*组成C语言的最小单元就是函数*

### 作用域

作用域指的是一个标识符在程序中有效的区域，一旦超出这个区域，该标识符就不能被访问。

#### 作用域类型

- 局部变量
- 全局变量

#### 局部变量

在函数内定义的变量(包括形参)；作用范围：本函数内部

定义在复合语句内的变量；作用范围：复合语句内部

```c
#include <stdio.h>
int main(){
    int a;
    a=1;
    {
        int b=2;
	b = a+b;
	a = a+b;
    }
    printf("%d",a);
    return 0;
}
```

其中 `a`变量作用域为整个 `main()`函数；`b`变量作用域为复合语句的花括号里面.

#### 全局变量

在函数以外定义的变量，不从属于任一函数。

作用范围：从定义处到源文件结束(包括各函数)
